<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<!-- Mobile Redirect -->
<script src="http://static.dudamobile.com/DM_redirect.js" type="text/javascript"></script>
<script type="text/javascript">DM_redirect("http://m.bioinformaticsalgorithms.com");</script>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>FAQs | Chapter 5 | How Do We Compare Biological Sequences? </title>
<link rel="stylesheet" type="/text/css" href="../Styles/960_24_col.css" />
<link rel="stylesheet" type="/text/css" href="../Styles/reset.css" />
<link rel="stylesheet" type="/text/css" href="../Styles/text.css" />



<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-51449831-1', 'bioinformaticsalgorithms.com');
  ga('send', 'pageview');

</script>


<!-- Needed for JQuery in order to have expandable FAQs -->
<script type="text/javascript" src="//code.jquery.com/jquery-1.11.0.min.js"></script>

<!-- JQuery Javascript code -->
<script>
 $(document).ready(function() {

	$('.faq_question').click(function() {

		if ($(this).parent().is('.open')){
			$(this).closest('.faq').find('.faq_answer_container').animate({'height':'0'},500);
			$(this).closest('.faq').removeClass('open');

			}else{
				var newHeight =$(this).closest('.faq').find('.faq_answer').height() +'px';
				$(this).closest('.faq').find('.faq_answer_container').animate({'height':newHeight},500);
				$(this).closest('.faq').addClass('open');
			}

	});

});
</script>

</head>

<body>

    <div id="content" class="container_24 clearfix">
      <div class="main-content">
        <div class="header-img">
          <img src="../images/header-img.jpg" alt="Bioinformatics Algorithms: An Active Learning Approach" width="960" height="330" />
        </div>
        <div class="nav">
          <ul>
            <li><a href="../index.htm">Home</a></li>
            <li><a href="../about-the-author.htm">Authors</a></li>
            <li><a href="../contents.htm">Contents</a></li>
            <li><a href="../faqs.htm">FAQs</a></li>
            <li><a href="../videos.htm">Videos & Slides</a></li>
                        <li><a href="https://secure.mybookorders.com/Orderpage/1402">Buy the Book!</a></li>
            <li><a class="active" href="../contact.htm">Contact</a></li>
          </ul>
        </div>

    	<div class="section-about">

<h1>Chapter 5: How Do We Compare Biological Sequences?</h1>

<h3><a name="week1"></a>(Coursera Week 1)</h3>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">Why is it called “dynamic programming”?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>You may be surprised, but sixty years ago, the word "programming" had nothing to do with computer programming, but instead referred to finding optimal programs, in the sense of finding a military schedule for logistics. In the 1950s, the inventor of dynamic programming, Richard Bellman, joined the RAND Corporation, which at the time was working on various contracts for the US Defense Department. At that time, the Secretary of Defense, Charles Wilson, was under pressure to reduce the military budget, including the research budget. Here is how Bellman described his interactions with Wilson and the birth of the term “dynamic programming”:</p>

				<blockquote>"[Wilson's] face would suffuse, he would turn red, and he would get violent if people used the term research in his presence. You can imagine how he felt, then, about the term mathematical… Hence, I felt I had to do something to shield Wilson and the Air Force from the fact that I was really doing mathematics inside the RAND Corporation. What title, what name, could I choose? In the first place I was interested in planning, in decision making, in thinking. But planning, is not a good word for various reasons. I decided therefore to use the word “programming”. I wanted to get across the idea that this was dynamic, this was multistage, this was time-varying I thought, lets kill two birds with one stone. Lets take a word that has an absolutely precise meaning, namely dynamic, in the classical physical sense. It also has a very interesting property as an adjective, and that is it's impossible to use the word dynamic in a pejorative sense. Try thinking of some combination that will possibly give it a pejorative meaning. It's impossible. Thus, I thought dynamic programming was a good name. It was something not even a Congressman could object to. So I used it as an umbrella for my activities."</blockquote>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">If dynamic programming is so powerful, then why don’t we transform all recursive algorithms into dynamic programming algorithms?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
                <p>Each recursive algorithm can be transformed into dynamic programming using a <strong>memoization</strong> technique that stores all results ever calculated by the recursive procedure in a table. When the recursive procedure calls an input which was already used, the results are just fetched from the table instead of launching a recursive call. However, memoization is only useful if your recursive algorithm arrives to the same situations many times, like in the case of <strong>RecursiveChange</strong>. For example, memoization becomes not very useful for algorithms like <strong>HanoiTowers </strong>since it is rarely called on the same input. Despite the fact that memoization does not immediately lead to an efficient non-recursive &nbsp;algorithm for the Towers of Hanoi, such algorithms do exist (see <a href="https://www.geeksforgeeks.org/iterative-tower-of-hanoi/" target="_blank" rel="noopener">https://www.geeksforgeeks.org/iterative-tower-of-hanoi/</a>).</p>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">Is it possible to develop an iterative rather than recursive algorithm for OutputLCS?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>Yes, and below is some pseudocode. &nbsp;Instead of making recursive calls, we simply embed the algorithm's iterations within a while loop.</p>

				<p><br></p>

				<pre><code><strong>IterativeOutputLCS</strong>(<em>Backtrack</em>, <em>v</em>, <em>w</em>)
<em>    LCS</em> ← an empty string
<em>    i</em> ← length of string
<em>    </em><em>j</em> ← length of string <em>w
</em><strong>    while</strong> <em>i</em> &gt; 0 and <em>j</em> &gt; 0
&nbsp;&nbsp;      <strong>if</strong> <em>Backtrack</em>(<em>i</em>, <em>j</em>) = "<span style="color: rgb(51, 51, 51); font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 20px; white-space: normal; background-color: rgb(249, 249, 249);"><font color="green">↓</font></span><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;">"
</span>&nbsp; &nbsp; &nbsp;       <em>i</em>&nbsp;← <em>i</em>-1
&nbsp; &nbsp;     <strong>else</strong> <strong>if</strong> Backtrack(i,j) = "<span style="color: rgb(51, 51, 51); font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 20px; white-space: normal; background-color: rgb(255, 255, 255);"><strong><font color="blue">→</font></strong></span><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;">"
</span>&nbsp; &nbsp; &nbsp;       <em>j</em> ← <em>j</em>-1
&nbsp; &nbsp;     <strong>else</strong> <strong>if</strong> Backtrack(i,j) = "<span style="color: rgb(51, 51, 51); font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 20px; white-space: normal; background-color: rgb(255, 255, 255);"><strong><font color="red">↘</font></strong></span><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;">"
 &nbsp;&nbsp;</span>&nbsp; &nbsp;        <em>LCS</em> ← concatenate <em>v<sub>i</sub></em> with <em>LCS</em>
<em>            i</em>&nbsp;← <em>i</em>-1
&nbsp; &nbsp; &nbsp;       <em>j</em>&nbsp; ← <em>j</em>-1<em>
</em><strong>    return</strong> <em>LCS</em></code></pre>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">Why do we favor vertical backtracking edges (over horizontal and diagonal) in <b>OutputLCS</b>?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>All three types of backtracking edges (horizontal, vertical, and diagonal) are equally important; <b>OutputLCS</b> simply starts the analysis with vertical edges because it has to start somewhere! This will indeed bias the solutions if there are <i>multiple</i> longest common subsequences, in which case you may want to vary backtracking over multiple runs.</p>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">If there are many topological orders, which one should I use for computing alignments?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>All topological orderings result in the same running time of your alignment algorithm, so you can choose any one you like.</p>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<h3><a name="week2"></a>(Coursera Week 2)</h3>


<div class="faq_container">
	<div class="faq">
		<div class="faq_question">Can you explain how to select penalties for insertions and deletions?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>Indel penalties are often implemented independent of the amino acid types in the inserted or deleted fragment, despite evidence that specific residue types are preferred in gap regions.  For example, all indel penalties in the PAM matrix presented in the book are equal to 8, independently of which amino acid is inserted or deleted. </p>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">How do we know where the conserved region in a local alignment starts and ends? </div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>If we knew in advance where the conserved region between two strings begins and ends, then we could simply change the source and sink to be the starting and ending nodes of the conserved interval. However, the key point is that we do not know this information in advance. Fortunately, since local alignment adds free taxi rides from the source (0,0) to <i>every</i> node (and from every node to the sink (<i>n</i>, <i>m</i>)) of the alignment graph, it explores <i>all</i> possible starting and ending positions of conserved regions.</p>
			</div>
		</div>
	</div>
</div>

<p><br></p>


<div class="faq_container">
	<div class="faq">
		<div class="faq_question">How do biologists decide when to use global alignment and when to use local alignment? </div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>Unless biologists have a good reason to align entire strings (e.g., alignment of genes between very close species such as human and chimpanzee), they use local alignment.</p>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">Are there advantages of using global alignment instead of local alignment? </div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>Yes. For example, when biologists analyze the evolutionary history of a protein across various species, they often use global alignment. Also, most multiple alignment tools align entire sequences, rather than their substrings, as it is difficult to determine which substrings to align in the case of multiple proteins.</p>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">How do we backtrack when computing a local alignment?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>As mentioned in the text, an optimal local alignment fits within a sub-rectangle in the alignment graph. We denote the upper right and bottom left nodes of this sub-rectangle as (<em>i</em>, <em>j</em>) and (<em>i</em>’, <em>j</em>’), respectively. &nbsp;Unless (<em>i</em>, <em>j</em>) = (0, 0) or (<em>i</em>’, <em>j</em>’) = (<em>n</em>, <em>m</em>), the local alignment corresponds to taking a free taxi ride (i.e., zero-weight edge) from (0, 0) to (<em>i</em>, <em>j</em>), taking one edge at a time to travel from&nbsp;&nbsp;(<em>i</em>,&nbsp;<em>j</em>) to&nbsp;(<em>i</em>’, <em>j</em>’), and then taking another free taxi ride from (<em>i</em>’, <em>j</em>’) to (<em>n</em>, <em>m</em>).<br>We already know that (<em>i</em>’, <em>j</em>’) can be computed as a node such that the score <em>s</em><sub><em>i</em>’,<em> j</em>’</sub> is maximized over all nodes of the entire alignment graph. The question, then, is how to backtrack from this node and to find &nbsp;(<em>i</em>,&nbsp;<em>j</em>).</p>

				<p><br></p>

				<p>Recall the three backtracking choices from the <strong>OutputLCS</strong> pseudocode corresponding to the backtracking references ("<span style="color: rgb(51, 51, 51); font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 20px; background-color: rgb(249, 249, 249);"><font color="green">↓</font></span>", &nbsp;"<strong style="color: rgb(51, 51, 51); font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 20px;"><font color="blue">→</font></strong>", and "<strong style="color: rgb(51, 51, 51); font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 20px;"><font color="red">↘</font></strong>"). To these, we will simply add one additional option, "FREE", which is used when we have used a free taxi ride from the source and will allow us to jump back to (0, 0) when backtracking. &nbsp;Thus, to find (<em>i</em>, <em>j</em>), one has to backtrack from (<em>i</em>’, <em>j</em>’) until we either reach a coordinate (<em>i</em>, <em>j</em>) with <em>Backtrack</em><sub><em>i, j</em></sub>&nbsp;= "FREE" or until we reach the source (0,0).</p>

				<p><br></p>

				<p>For simplicity, the following <strong>LocalAlignment</strong> pseudocode assumes that <em>s<sub>i, j</sub></em> &nbsp;= -∞ if <em>i</em>&nbsp;&lt; 0 or <em>j</em>&nbsp;&lt; 0.</p>

				<p><br></p>

				<pre><code><strong>LocalAlignment</strong>(<em>v</em>, <em>w</em>, <em>Score</em>)
&nbsp; &nbsp;<strong>for</strong> <em>i</em> ← 0 to |<em>v</em>|
&nbsp; &nbsp; &nbsp; <strong>for</strong> <em><u>j</u></em> ← 0 to |<em>w</em>|
 &nbsp; &nbsp; &nbsp; &nbsp; <em>s<sub>i,j</sub></em> ← max{0, <em style="color:green">s</em><font color="green"><sub><i>i</i>-1,<i>j</i></sub> + <em>Score</em>(<em>v<sub>i</sub></em>, -)</font>, <font color="blue"><em>s</em><sub><em>i,j</em>-1 </sub>+ <em>Score</em>(-, <em>w<sub>j</sub></em>)</font>, </span><font color="red"><em>s</em><sub><em>i</em>-1,<em>j</em>-1</sub> + <em>Score</em>(<em>v<sub>i</sub></em>, <em>w<sub>j</sub></em>)</font>}
</span>         <strong>if <em></em></strong><em>s<sub>i,j</sub></em> = 0
            <em>Backtrack<sub>i,j</sub></em> ← "FREE"
         <em><strong></strong></em><strong>else </strong><strong>if </strong><em></em><em>s<sub>i,j</sub></em> = <em>s</em><sub><em>i</em>-1,<em>j</em></sub> + <em>Score</em>(<em>v<sub>i</sub></em>, -)<b>
            </b><em>Backtrack<sub>i,j</sub></em> ← "<font color="green">↓</font>"
         <strong>else if </strong><em>s<sub>i,j</sub></em> = <em>s<sub>i,j</sub></em>-1 + <em>Score</em>(-, <em>w<sub>j</sub></em>)
            <em>Backtrack<sub>i,j</sub></em> ← "<font color="blue">→</font>"
         <strong>else</strong> <em>Backtrack<sub>i,j</sub></em> ← "<font color="red">↘</font>"
&nbsp; &nbsp;<strong>return</strong> <em>Backtrack</em></code></pre>


<p>After computing backtracking references, we can compute the source node of the local alignment by invoking <strong>LocalAlignmentSource</strong>(<em>Backtrack, i', j'</em>), where (<em>i', j'</em>) is the sink of the local alignment computed as a node with maximum score among all nodes in the alignment graph. The <b>LocalAlignmentSource</b> pseudocode is shown below.</p>

<p><br></p>

<pre><code><strong>LocalAlignmentSource</strong>(<em>Backtrack</em>, <em>i</em>, <em>j</em>)
&nbsp; &nbsp;<strong>while</strong>&nbsp;<em>i</em> &gt; 0 or <em>j</em>&nbsp;&gt; 0
&nbsp;&nbsp; &nbsp; &nbsp;<strong>if</strong> <em>Backtrack</em>(<em>i</em>, <em>j</em>) ="FREE"
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<strong>return</strong> (<em>i</em>, <em>j</em>)
&nbsp; &nbsp; &nbsp; <strong>else if</strong> Backtrack(<em>i</em>, <em>j</em>) = "<font color="green">↓</font>"
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<em>i</em> &nbsp;←&nbsp;<em>i&nbsp;</em>- 1
&nbsp; &nbsp; &nbsp; <strong>else if</strong> <em>Backtrack</em>(<em>i</em>, <em>j</em>) = "<font color="blue">→</font>"
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<em>j</em> &nbsp;←&nbsp;<em>j&nbsp;</em>- 1
&nbsp; &nbsp; &nbsp; <strong>else if</strong> Backtrack(<em>i</em>, <em>j</em>) = "<font color="red">↘</font>"
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <em>i</em> &nbsp;←&nbsp;<em>i</em>&nbsp;- 1
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<em>j</em> &nbsp;←&nbsp;<em>j</em>&nbsp;- 1
&nbsp; &nbsp;<strong>return</strong> (0,0)</code></pre>

			</div>
		</div>
	</div>
</div>



<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">Can you help me understand how to set up different alignment problems as an instance of the Longest Path in a DAG Problem?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>Please take a look at the following figure for a big hint.</p>

				<p><br></p>

				<figure><center><img src="../images/Alignment/taxi_rides_different_alignments.png" width="70%"></center></figure>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">If we have two newly sequenced proteins and don't know how different they are to begin with, how do we know which scoring matrix to use?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>Indeed, selection of an appropriate PAM<sub><i>n</i></sub> matrix is tricky, and biologists often use trial-and-error to select the most “reasonable” value of <i>n</i>  when considering newly sequenced proteins. For this reason, they devised new BLOSUM matrices that are a bit easier to apply for protein comparison. See <a href="https://doi.org/10.1002/0471250953.bi0305s43" target="_blank">W.R. Pearson.  Selecting the Right Similarity-Scoring Matrix, <i>Current Protocols in Bioinformatics</i> (2013)</a>.  </p>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<h3><a name="week3"></a>(Coursera Week 3)</h3>


<div class="faq_container">
	<div class="faq">
		<div class="faq_question">When building a Manhattan graph in three levels to perform affine sequence alignment, can’t we avoid building the three-level graph by using a two-level graph and keeping track of gap penalties each time we open a gap?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>The problem with this idea is that when computing the score at a node (<i>i</i>, <i>j</i>), we need to take into account the score of closing a gap from every node in the same row and same column.  This is exactly what long indel edges do, and what we are trying to avoid in order to reduce the runtime of the algorithm by decreasing the number of edges in the graph.</p>

				<p><br></p>

				<p>For example, the figure below illustrates the two-level Manhattan for computing alignment with affine gap penalties (compare with the 3-level Manhattan shown in the text). At first glance, it looks like it solves the Alignment with Affine Gap Penalties Problem.</p>

				<p><br></p>

				<p><center><img src="../images/Alignment/two_level_affine_graph.png" width="600"></center></p>

				<p><br></p>

				<p>However, it you consider the following alignment with two gaps,</p>

				<p><br></p>

				<pre><center>ATT--AA
A--GGAA</center></pre>

                <p><br></p>

                <p>you will see that the path through the two-level graph for this alignment (shown below) miscalculates the alignment score; whereas the score of the alignment above is 3-2*(σ+ε), the score of the alignment in the figure below is 3- σ-3*ε.</p>

                <p><br></p>

				<p><center><img src="../images/Alignment/two_level_affine_graph_path.png" width="600"></center></p>
			</div>
		</div>
	</div>
</div>



<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">When building a Manhattan graph in three levels to perform affine sequence alignment, would it be more natural to connect (<i>i</i>, <i>j</i>)<sub>middle</sub> to the nodes (<i>i</i>, <i>j</i>)<sub>lower</sub>  and  (<i>i</i>, <i>j</i>)<sub>upper</sub> (instead of connecting them with (<i>i</i>+1, <i>j</i>)<sub>lower</sub>  and (<i>i</i>, <i>j</i>+1)<sub>upper</sub>?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>Connecting (<i>i</i>, <i>j</i>)<sub>middle</sub> to the nodes (<i>i</i>, <i>j</i>)<sub>lower</sub>  and  (<i>i</i>, <i>j</i>)<sub>upper</sub> (and assigning the edges a score of σ - ε) indeed seems like a more elegant approach to building a three-level Manhattan. However, in this case we would create directed cycles, since there would exist edges from  (<i>i</i>, <i>j</i>)<sub>lower</sub>  and  (<i>i</i>, <i>j</i>)<sub>upper</sub> back to (<i>i</i>, <i>j</i>)<sub>middle</sub> .</p>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">Why are there no edges connecting nodes in the upper level directly to the nodes in lower level in the three-level affine gap penalty alignment graph? </div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>It appears that the alignment path in the one-level alignment graph shown below, which has a deletion of <span style="color: #339966;">TT</span> directly followed by an insertion of <span style="color: #3366ff;">AA</span>, is best represented by a sequence of edges that includes a direct edge from the lower level to the upper level.</p>

                <p><br></p>

                <p><center><img src="../images/Alignment/alignment_three_level_faq_1.png"></center></p>

                <p><br></p>

                <p>However, such an edge is unnecessary because it can be represented by an edge from the lower to the middle level (weight 0) along with an edge from the middle to the upper level (weight -&sigma;).</p>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">What topological order should we use to move in the three-level Manhattan graph for affine sequence alignment? </div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>Please consult the following figure, which shows a topological order for a small three-level graph in which we proceed row-by-row in each level. (The topological order corresponds to visiting the nodes in increasing order, from 1 to 36.)  Because there are some edges from (<i>i</i>, <i>j</i>)<sub>lower</sub> to (<i>i</i>, <i>j</i>)<sub>middle</sub> and from (<i>i</i>, <i>j</i>)<sub>upper</sub> to (<i>i</i>, <i>j</i>)<sub>middle</sub> for each <i>i</i> and <i>j</i>, we need to make sure that we visit (<i>i</i>, <i>j</i>)<sub>lower</sub> and (<i>i</i>, <i>j</i>)<sub>upper</sub> before (<i>i</i>, <i>j</i>)<sub>middle</sub>.</p>

<p><br></p>

<figure><center><img src="../images/Alignment/three_level_toplogical_order.png" width="50%"></center></figure>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question"> How can we backtrack in the three-level Manhattan for alignment with affine gap penalties? </div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>Alignment with affine gap penalties is merely a search for a longest path in a DAG. Thus, backtracking in this graph is no different that backtracking in an arbitrary DAG, starting at the sink and proceeding toward the source according to a topological order. This reduces the problem to identifying a topological order, of which there are several. </p>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">How should we perform initialization for the Alignment with Affine Gap Penalties Problem?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>It may be tricky to determine how to initialize the <em>lower</em>, <em>upper</em>, and <em>middle</em> matrices in the Alignment with Affine Gap Penalties Problem.  For this reason, it may be easier to construct a DAG for this problem, approaching it as a general Longest Path in a DAG problem. Since we are interested in paths that start at the node (0,0) in the middle graph, we initialize this node with score 0. However, it is not the only node lacking incoming edges in the three-level graph for the Alignment with Affine Gap Penalties Problem, since the two other nodes <em>lower<sub>0,0</sub></em> and <em>upper<sub>0,0</sub></em> have this property as well. We therefore will initialize these two nodes with score -∞, since valid paths in the alignment graph must start at <em>middle<sub>0,0</sub></em>.</p>

                <p><br></p>

                <p>Note also that the recurrence relationships for the the Alignment with Affine Gap Penalties Problem include negative indices. For example, we must compute <em>middle<sub>i,-1 </sub></em>before computing <em>middle<sub>i,o</sub></em>. We therefore will also set the values of all variables with negative indices to -&infin;.</p>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">In space-efficient sequence alignment, what should we do if there are multiple middle nodes?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>If the array <em>Length</em>(<em>i</em>) has more than one element of maximum value, then you can choose any of them, breaking ties arbitrarily.</p>

                <p><br></p>

                <p>It is also possible for a single longest path to have multiple middle nodes.  This occurs if such a path has a vertical edge right after reaching the middle column (i.e., a path that traverses one or more edges in the middle column).</p>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">Why did we switch from finding a middle node to finding a middle edge in space-efficient alignment?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>The shaded parts of the alignment graph to the northwest and southeast of the middle node make up more than half of the total area of the alignment graph.  In contrast, the shaded parts of the alignment graph to the northwest and southeast of the middle <em>edge</em> make up less than half of the total area of the alignment graph.  This implies that when we divide and conquer based on the middle node, we obtain runtime greater than 2<em>nm</em>, whereas when we divide and conquer based on the middle edge, we obtain runtime less than 2<em>nm</em>.</p>

                <p><br></p>

                <p>Although it may appear that switching from finding a middle node to finding a middle edge results in only a small speed-up and does not affect the asymptotic O(<em>nm</em>) estimate of the running time, it allows us to eliminate some annoying corner cases and simplify the pseudocode.</p>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">Can I see an illustration of LinearSpaceAlignment?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
                <p>Below we illustrate how <strong>LinearSpaceAlignment</strong> works in the case <em>top</em> = 0, <em>bottom</em> = 8, <em>left</em> = 0, <em>right</em> = 8 shown below:</p>

                <p><br></p>

                <p><center><img src="../images/Alignment/middle_edge-1.png" width="500"></center></p>

                <p><br></p>

                <p>The numbers below in blue illustrate how variables change during the execution of <strong>LinearSpaceAlignment</strong> and result in two recursive calls <strong>LinearSpaceAlignment</strong>(<em>v, w</em>, 0, 4, 0, 4) and <strong>LinearSpaceAlignment</strong>(<em>v, w, </em>5, 8, 5, 8) illustrated by two blue rectangles above. In the case when <em>midEdge</em> is horizontal or diagonal, the left blue rectangle is shifted by one column to the right as compared to the middle column (the line <em>middle</em>&nbsp;&larr;&nbsp;<em>middle&nbsp;</em>+ 1). In the case when <em>midEdge</em> is vertical or diagonal, the left blue rectangle is shifted by one row to the bottom as compared to the position of the middle node (the line <em>midNode</em>&nbsp;&larr;&nbsp;<em>midNode</em>+1).</p>

                <p><br></p>

                <p><center><img src="../images/Alignment/linear_space_alignment_faq.png"></img></center></p>
			</div>
		</div>
	</div>
</div>

<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">Is it possible to develop a linear-space algorithm for alignment with affine gap penalties?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				It is possible to extend our idea from pariwise alignment (in order to find a longest common subsequence) to more complex scoring models, e.g., for alignment with affine gap penalties. The only question is where to place the "middle column". It turns out that we need to consider <i>two</i> middle columns to implement the divide-and-conquer linear-space algorithm for alignment with affine gap penalties; try to figure out which ones!
			</div>
		</div>
	</div>
</div>



<p><br></p>

<div class="faq_container">
	<div class="faq">
		<div class="faq_question">How would we align a nucleotide string of length <i>n</i> against a profile of length <i>k</i>, i.e., against a 4 x <i>m</i> matrix?</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				<p>Every alignment of a string <i>v</i> against a profile <i>Profile</i> = (<i>P</i><sub><i>X</i>, <i>j</i></sub>) (for <i>X</i> ∈ {<tt>A</tt>, <tt>C</tt>, <tt>G</tt>, <tt>T</tt>}, and 1 ≤ j ≤ m) can be represented as a path from (0,0) to (<i>n</i>, <i>m</i>) in the alignment graph. We can define scores of vertical and horizontal edges in this graph as before, i.e., by assigning penalties sigma to indels. There are various ways to assign scores to diagonal edges, e.g, a diagonal edge into a node (<i>i</i>, <i>j</i>) can be assigned a score <i>P</i><sub><i>vi</i>, <i>j</i></sub>. After the scores of all edges are specified, an optimal alignment between a string and a profile is computed as a longest path in the alignment graph.</p>
			</div>
		</div>
	</div>
</div>


<!--
<div class="faq_container">
	<div class="faq">
		<div class="faq_question">Question here</div>
		<div class="faq_answer_container">
			<div class="faq_answer">
				Answer here
			</div>
		</div>
	</div>
</div>
-->


		</div>
	</div>
  <div id="footer" class="container_24 clearfix">
          <div class="footer-links">
     <img style="float: left;" src="/../images/alp_logo.png" alt="Active Learning Publishers" height="50" />  <a style="float: right;" href="http://rosalind.info/problems/list-view/?location=bioinformatics-textbook-track" target="_blank"><img style="padding:10px;"  src="/images/rosalind_logo_white.png" alt="Rosalind" height="50" /></a>
     &#169; 2018 by Phillip Compeau &amp; Pavel Pevzner | All Rights Reserved<br>
      ISBN: 978-0-9903746-3-3<br>
    </div>
  </div>


</body>
</html>
